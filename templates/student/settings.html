{% extends "base.html" %} 
{% load static %} 
{% if not user.is_authenticated %}
{% url 'login' as login %}
<script>
  window.location.href = "{{ login }}?next={{ request.path|urlencode }}";
</script>
{% else %} 
{% block title %}Settings - WachemoSaPS{% endblock %} 

{% block content %}

<div class="max-w-7xl mx-auto px-4 py-6 grid grid-cols-1 md:grid-cols-[16rem_1fr] gap-6">
  {% include "student/sidebar.html" %}
  <main>
    <div class="space-y-6">
      <div>
        <h3 class="text-2xl font-semibold">Account Settings</h3>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Profile Settings -->
        <div class="border rounded shadow-sm">
          <div class="px-4 py-2 bg-gray-50 border-b">
            <h5 class="font-semibold"><i class="fas fa-user-gear mr-2"></i>Profile Information</h5>
          </div>
          <div class="p-4">
            <form id="profileForm" class="space-y-3">
              <div>
                <label for="firstName" class="block text-sm font-medium">First Name</label>
                <input type="text" class="mt-1 w-full border rounded px-3 py-2" id="firstName" value="{{ user.first_name }}" />
              </div>
              <div>
                <label for="lastName" class="block text-sm font-medium">Last Name</label>
                <input type="text" class="mt-1 w-full border rounded px-3 py-2" id="lastName" value="{{ user.last_name }}" />
              </div>
              <div>
                <label for="email" class="block text-sm font-medium">Email Address</label>
                <input type="email" class="mt-1 w-full border rounded px-3 py-2" id="email" value="{{ user.email }}" />
              </div>
              <div>
                <label for="phone" class="block text-sm font-medium">Phone Number</label>
                <input type="tel" class="mt-1 w-full border rounded px-3 py-2" id="phone" value="{{ user.student.phone|default:'' }}" />
              </div>
              <button type="submit" class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded">Update Profile</button>
            </form>
          </div>
        </div>

        <!-- Security Settings -->
        <div class="border rounded shadow-sm">
          <div class="px-4 py-2 bg-gray-50 border-b">
            <h5 class="font-semibold"><i class="fas fa-shield-halved mr-2"></i>Security Settings</h5>
          </div>
          <div class="p-4">
            <form id="passwordForm" class="space-y-3">
              <div>
                <label for="email" class="block text-sm font-medium">Email Address</label>
                <input type="email" class="mt-1 w-full border rounded px-3 py-2" id="email" />
              </div>
              <div>
                <label for="currentPassword" class="block text-sm font-medium">Current Password</label>
                <input type="password" class="mt-1 w-full border rounded px-3 py-2" id="currentPassword" />
              </div>
              <div>
                <label for="newPassword" class="block text-sm font-medium">New Password</label>
                <input type="password" class="mt-1 w-full border rounded px-3 py-2" id="newPassword" />
              </div>
              <div>
                <label for="confirmPassword" class="block text-sm font-medium">Confirm New Password</label>
                <input type="password" class="mt-1 w-full border rounded px-3 py-2" id="confirmPassword" />
              </div>
              <button type="submit" class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded">Change Password</button>
            </form>
          </div>
        </div>
      </div>

      <!-- Notification Preferences and Account Preferences -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="border rounded shadow-sm">
          <div class="px-4 py-2 bg-gray-50 border-b">
            <h5 class="font-semibold"><i class="fas fa-bell mr-2"></i>Notification Preferences</h5>
          </div>
          <div class="p-4">
            <form id="notificationForm" class="space-y-3">
              <label class="flex items-center gap-2"><input class="rounded" type="checkbox" id="emailNotifications" checked /> <span>Email Notifications</span></label>
              <label class="flex items-center gap-2"><input class="rounded" type="checkbox" id="smsNotifications" /> <span>SMS Notifications</span></label>
              <label class="flex items-center gap-2"><input class="rounded" type="checkbox" id="assignmentAlerts" checked /> <span>Assignment Alerts</span></label>
              <label class="flex items-center gap-2"><input class="rounded" type="checkbox" id="gradeAlerts" checked /> <span>Grade Updates</span></label>
              <label class="flex items-center gap-2"><input class="rounded" type="checkbox" id="eventReminders" checked /> <span>Event Reminders</span></label>
              <label class="flex items-center gap-2"><input class="rounded" type="checkbox" id="classReminders" checked /> <span>Class Reminders</span></label>
              <button type="submit" class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded">Save Preferences</button>
            </form>
          </div>
        </div>

        <div class="border rounded shadow-sm">
          <div class="px-4 py-2 bg-gray-50 border-b">
            <h5 class="font-semibold"><i class="fas fa-gear mr-2"></i>Account Preferences</h5>
          </div>
          <div class="p-4">
            <form id="preferencesForm" class="space-y-3">
              <div>
                <label for="language" class="block text-sm font-medium">Language</label>
                <select class="mt-1 w-full border rounded px-3 py-2" id="language">
                  <option value="en" selected>English</option>
                  <option value="am">Amharic</option>
                  <option value="om">Oromifa</option>
                </select>
              </div>
              <div>
                <label for="theme" class="block text-sm font-medium">Theme</label>
                <select class="mt-1 w-full border rounded px-3 py-2" id="theme">
                  <option value="light" selected>Light</option>
                  <option value="dark">Dark</option>
                  <option value="system">System Default</option>
                </select>
              </div>
              <div>
                <label for="timezone" class="block text-sm font-medium">Timezone</label>
                <select class="mt-1 w-full border rounded px-3 py-2" id="timezone">
                  <option value="Africa/Addis_Ababa" selected>Addis Ababa (EAT)</option>
                  <option value="UTC">UTC</option>
                </select>
              </div>
              <button type="submit" class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded">Save Preferences</button>
            </form>
          </div>
        </div>
      </div>

      <!-- Danger Zone -->
      <div class="border border-red-300 rounded shadow-sm">
        <div class="px-4 py-2 bg-red-600 text-white rounded-t">
          <h5 class="font-semibold"><i class="fas fa-triangle-exclamation mr-2"></i>Danger Zone</h5>
        </div>
        <div class="p-4 space-y-4">
          <div class="flex items-start justify-between gap-4">
            <div>
              <h6 class="font-semibold">Deactivate Account</h6>
              <p class="text-sm text-gray-600">Temporarily disable your account. You can reactivate it later by logging in.</p>
            </div>
            <button class="border px-3 py-2 rounded" id="deactivateTrigger">Deactivate Account</button>
          </div>
          <div class="flex items-start justify-between gap-4">
            <div>
              <h6 class="font-semibold">Delete Account</h6>
              <p class="text-sm text-gray-600">Permanently delete your account and all associated data. This cannot be undone.</p>
            </div>
            <button class="bg-red-600 text-white px-4 py-2 rounded" id="deleteTrigger">Delete Account</button>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

{% endblock %} 

{% endif %}